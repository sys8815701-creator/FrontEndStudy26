<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>블로그 글 - 기술 블로그</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .post-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 0;
            margin-bottom: 40px;
        }
        .post-content {
            font-size: 1.1rem;
            line-height: 1.8;
        }
        .comment-item {
            border-left: 3px solid #007bff;
            padding-left: 15px;
            margin-bottom: 20px;
        }
        .reply-item {
            margin-left: 40px;
            border-left: 3px solid #6c757d;
            padding-left: 15px;
        }
        .share-buttons button {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">Tech Blog</a>
            <a href="#" class="btn btn-outline-light btn-sm">목록으로</a>
        </div>
    </nav>

    <div class="post-header">
        <div class="container">
            <span class="badge bg-light text-dark mb-2">JavaScript</span>
            <h1 class="display-4">JavaScript 비동기 프로그래밍 완벽 가이드</h1>
            <div class="mt-3">
                <span class="me-3">작성자: 김개발</span>
                <span class="me-3">작성일: 2024-01-15</span>
                <span>조회수: 1,250</span>
            </div>
        </div>
    </div>

    <div class="container mb-5">
        <div class="row">
            <div class="col-lg-8">
                <article class="post-content">
                    <p>JavaScript에서 비동기 프로그래밍은 필수적인 개념입니다. 서버와 통신하거나, 파일을 읽거나, 타이머를 설정하는 등의 작업은 모두 비동기로 처리됩니다.</p>

                    <h3 class="mt-4">Promise란?</h3>
                    <p>Promise는 비동기 작업의 완료 또는 실패를 나타내는 객체입니다. 콜백 지옥을 해결하고 더 깔끔한 코드를 작성할 수 있게 해줍니다.</p>

                    <pre class="bg-light p-3 rounded"><code>const promise = new Promise((resolve, reject) => {
    setTimeout(() => {
        resolve('성공!');
    }, 1000);
});

promise.then(result => console.log(result));</code></pre>

                    <h3 class="mt-4">async/await 활용</h3>
                    <p>async/await는 Promise를 더 편리하게 사용할 수 있게 해주는 문법입니다.</p>
                </article>

                <div class="share-buttons mt-5">
                    <h5>이 글 공유하기</h5>
                    <button class="btn btn-primary" onclick="shareToSocial('facebook')">Facebook</button>
                    <button class="btn btn-info text-white" onclick="shareToSocial('twitter')">Twitter</button>
                    <button class="btn btn-success" onclick="shareToSocial('kakao')">KakaoTalk</button>
                    <button class="btn btn-secondary" onclick="copyLink()">링크 복사</button>
                </div>

                <hr class="my-5">

                <section id="comments">
                    <h4 class="mb-4">댓글 <span class="badge bg-primary" id="commentCount">0</span></h4>

                    <div class="card mb-4">
                        <div class="card-body">
                            <form id="commentForm">
                                <div class="mb-3">
                                    <input type="text" class="form-control" id="commentAuthor" placeholder="이름" required>
                                </div>
                                <div class="mb-3">
                                    <textarea class="form-control" id="commentContent" rows="3" placeholder="댓글을 입력하세요" required></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">댓글 작성</button>
                            </form>
                        </div>
                    </div>

                    <div id="commentList">
                        <!-- 댓글 목록이 여기에 동적으로 추가됩니다 -->
                    </div>
                </section>
            </div>

            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header">
                        <h5>최근 글</h5>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <a href="#" class="text-decoration-none">CSS Grid 완벽 가이드</a>
                        </li>
                        <li class="list-group-item">
                            <a href="#" class="text-decoration-none">RESTful API 설계</a>
                        </li>
                        <li class="list-group-item">
                            <a href="#" class="text-decoration-none">Vue.js 시작하기</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        let comments = [];
        let commentIdCounter = 1;

        // 댓글 렌더링
        function renderComments() {
            const commentList = $('#commentList');
            commentList.empty();

            comments.forEach(comment => {
                const commentHtml = `
                    <div class="comment-item" data-id="${comment.id}">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <div>
                                <strong>${comment.author}</strong>
                                <small class="text-muted ms-2">${comment.date}</small>
                            </div>
                            <div>
                                <button class="btn btn-sm btn-outline-primary reply-btn" data-id="${comment.id}">답글</button>
                                <button class="btn btn-sm btn-outline-danger delete-btn" data-id="${comment.id}">삭제</button>
                            </div>
                        </div>
                        <p>${comment.content}</p>
                        <div class="reply-form-container" id="replyForm-${comment.id}" style="display:none;">
                            <form class="reply-form mt-2" data-parent-id="${comment.id}">
                                <div class="input-group mb-2">
                                    <input type="text" class="form-control form-control-sm" placeholder="이름" required>
                                    <textarea class="form-control form-control-sm" placeholder="답글 내용" required></textarea>
                                    <button type="submit" class="btn btn-sm btn-primary">작성</button>
                                </div>
                            </form>
                        </div>
                        <div class="replies-container" id="replies-${comment.id}">
                            ${renderReplies(comment.replies)}
                        </div>
                    </div>
                `;
                commentList.append(commentHtml);
            });

            $('#commentCount').text(comments.length);
        }

        // 답글 렌더링
        function renderReplies(replies) {
            if (!replies || replies.length === 0) return '';

            return replies.map(reply => `
                <div class="reply-item mt-2">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <div>
                            <strong>${reply.author}</strong>
                            <small class="text-muted ms-2">${reply.date}</small>
                        </div>
                        <button class="btn btn-sm btn-outline-danger delete-reply-btn" data-id="${reply.id}">삭제</button>
                    </div>
                    <p>${reply.content}</p>
                </div>
            `).join('');
        }

        // 댓글 작성
        $('#commentForm').submit(function(e) {
            e.preventDefault();

            const author = $('#commentAuthor').val();
            const content = $('#commentContent').val();

            const newComment = {
                id: commentIdCounter++,
                author: author,
                content: content,
                date: new Date().toLocaleString('ko-KR'),
                replies: []
            };

            comments.push(newComment);
            renderComments();

            $('#commentAuthor').val('');
            $('#commentContent').val('');

            alert('댓글이 작성되었습니다!');
        });

        // 답글 버튼 클릭
        $(document).on('click', '.reply-btn', function() {
            const commentId = $(this).data('id');
            $(`#replyForm-${commentId}`).slideToggle();
        });

        // 답글 작성
        $(document).on('submit', '.reply-form', function(e) {
            e.preventDefault();

            const parentId = $(this).data('parent-id');
            const author = $(this).find('input').val();
            const content = $(this).find('textarea').val();

            const newReply = {
                id: commentIdCounter++,
                author: author,
                content: content,
                date: new Date().toLocaleString('ko-KR')
            };

            const comment = comments.find(c => c.id === parentId);
            if (comment) {
                comment.replies.push(newReply);
                renderComments();
                alert('답글이 작성되었습니다!');
            }
        });

        // 댓글 삭제
        $(document).on('click', '.delete-btn', function() {
            if (confirm('댓글을 삭제하시겠습니까?')) {
                const commentId = $(this).data('id');
                comments = comments.filter(c => c.id !== commentId);
                renderComments();
            }
        });

        // 공유 기능
        function shareToSocial(platform) {
            const url = window.location.href;
            const title = document.title;

            alert(`${platform}으로 공유 기능은 실제 서비스에서 구현됩니다.`);
        }

        function copyLink() {
            const url = window.location.href;
            navigator.clipboard.writeText(url).then(() => {
                alert('링크가 클립보드에 복사되었습니다!');
            });
        }

        // 초기 렌더링
        renderComments();
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>페이지네이션 예제</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2>상품 목록</h2>

        <!-- 상품 목록 영역 -->
        <div id="productList" class="row g-3 mb-4">
            <!-- 동적으로 생성됨 -->
        </div>

        <!-- 페이지네이션 -->
        <nav aria-label="상품 목록 페이지네이션">
            <ul class="pagination justify-content-center" id="pagination">
                <!-- 동적으로 생성됨 -->
            </ul>
        </nav>

        <!-- 로딩 표시 -->
        <div id="loading" class="text-center d-none">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">로딩 중...</span>
            </div>
        </div>
    </div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
<script src="pagination.js"></script>
<script>
// pagination.js
$(document).ready(function() {
    const itemsPerPage = 12; // 페이지당 아이템 수
    let currentPage = 1;
    let totalPages = 0;

    // 가상의 상품 데이터 생성 (실제로는 서버에서 받아옴)
    const allProducts = [];
    for (let i = 1; i <= 100; i++) {
        allProducts.push({
            id: i,
            name: `상품 ${i}`,
            price: Math.floor(Math.random() * 100000) + 10000
        });
    }

    totalPages = Math.ceil(allProducts.length / itemsPerPage);

    // 상품 목록 렌더링
    function renderProducts(page) {
        $('#loading').removeClass('d-none');
        $('#productList').empty();

        // 실제로는 AJAX 요청을 보내지만, 여기서는 시뮬레이션
        setTimeout(function() {
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageProducts = allProducts.slice(startIndex, endIndex);

            pageProducts.forEach(function(product) {
                const productCard = `
                    <div class="col-md-3">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">${product.name}</h5>
                                <p class="card-text">${product.price.toLocaleString()}원</p>
                                <button class="btn btn-primary btn-sm">상세보기</button>
                            </div>
                        </div>
                    </div>
                `;
                $('#productList').append(productCard);
            });

            $('#loading').addClass('d-none');
        }, 500);
    }

    // 페이지네이션 UI 생성
    function renderPagination() {
        $('#pagination').empty();

        // 이전 버튼
        const prevDisabled = currentPage === 1 ? 'disabled' : '';
        $('#pagination').append(`
            <li class="page-item ${prevDisabled}">
                <a class="page-link" href="#" data-page="${currentPage - 1}">이전</a>
            </li>
        `);

        // 페이지 번호 (최대 5개씩 표시)
        const startPage = Math.max(1, currentPage - 2);
        const endPage = Math.min(totalPages, startPage + 4);

        for (let i = startPage; i <= endPage; i++) {
            const active = i === currentPage ? 'active' : '';
            $('#pagination').append(`
                <li class="page-item ${active}">
                    <a class="page-link" href="#" data-page="${i}">${i}</a>
                </li>
            `);
        }

        // 다음 버튼
        const nextDisabled = currentPage === totalPages ? 'disabled' : '';
        $('#pagination').append(`
            <li class="page-item ${nextDisabled}">
                <a class="page-link" href="#" data-page="${currentPage + 1}">다음</a>
            </li>
        `);
    }

    // 페이지 변경 이벤트
    $(document).on('click', '.page-link', function(e) {
        e.preventDefault();
        const page = parseInt($(this).data('page'));

        if (page >= 1 && page <= totalPages && page !== currentPage) {
            currentPage = page;
            renderProducts(currentPage);
            renderPagination();

            // 페이지 최상단으로 스크롤
            $('html, body').animate({ scrollTop: 0 }, 300);
        }
    });

    // 초기 로딩
    renderProducts(currentPage);
    renderPagination();
});
</script>
</body>
</html>